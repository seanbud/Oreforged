"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.useFacetWrapMemo = void 0;
const react_1 = require("react");
const equalityChecks_1 = require("../equalityChecks");
const facet_1 = require("../facet");
const types_1 = require("../types");
/**
 * Wraps a FacetProp as a Facet, ensuring the resulting Facet is memoized (even if the wrapped value changes)
 * @param value
 */
function useFacetWrapMemo(prop, equalityCheck = equalityChecks_1.defaultEqualityCheck) {
    /**
     * Inline facet that only created if the provided prop is not a facet.
     *
     * We ignore the dependency change of `prop` since we want to update the inline
     * facet value via the setter below.
     */
    const inlineFacet = (0, react_1.useMemo)(() => (0, facet_1.createFacet)({ initialValue: (0, types_1.isFacet)(prop) ? prop.get() : prop, equalityCheck }), 
    // eslint-disable-next-line react-hooks/exhaustive-deps
    [equalityCheck]);
    (0, react_1.useEffect)(() => {
        const is = (0, types_1.isFacet)(prop);
        if (is) {
            return prop.observe(inlineFacet.set);
        }
        inlineFacet.set(prop);
    }, [prop, inlineFacet]);
    return inlineFacet;
}
exports.useFacetWrapMemo = useFacetWrapMemo;
//# sourceMappingURL=useFacetWrapMemo.js.map