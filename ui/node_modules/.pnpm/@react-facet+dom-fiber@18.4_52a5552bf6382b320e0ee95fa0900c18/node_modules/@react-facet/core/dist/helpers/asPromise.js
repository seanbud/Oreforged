"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.asPromise = void 0;
const types_1 = require("../types");
/**
 * Takes a Facet and returns a Promise that will resolve with its first value
 *
 * @param facet
 * @returns Promise<T>
 */
const asPromise = (facet) => {
    let resolve = noop;
    const promise = new Promise((_resolve) => {
        resolve = _resolve;
    });
    const value = facet.get();
    if (value !== types_1.NO_VALUE) {
        resolve(value);
        return {
            promise,
            cancel: noop,
        };
    }
    const cleanup = facet.observe(resolve);
    return {
        promise: promise.then((value) => {
            cleanup();
            return value;
        }),
        cancel: cleanup,
    };
};
exports.asPromise = asPromise;
const noop = () => { };
//# sourceMappingURL=asPromise.js.map