"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const __1 = require("..");
const mapFacetSingleCached_1 = require("./mapFacetSingleCached");
const mapFacetSingleLightweight_1 = require("./mapFacetSingleLightweight");
describe.each([mapFacetSingleCached_1.mapFacetSingleCached, mapFacetSingleLightweight_1.mapFacetSingleLightweight])('test', (fn) => {
    it('initial value on get', () => {
        const dependency = (0, __1.createFacet)({ initialValue: { value: 1 } });
        const result = fn(dependency, (a) => ({ value: `${a.value}` }), __1.shallowObjectEqualityCheck);
        expect(result.get()).toEqual({ value: '1' });
    });
    it('initial value on observe', () => {
        const dependency = (0, __1.createFacet)({ initialValue: { value: 1 } });
        const result = fn(dependency, (a) => ({ value: `${a.value}` }), __1.shallowObjectEqualityCheck);
        const listener = jest.fn();
        result.observe(listener);
        expect(listener).toHaveBeenCalledWith({ value: '1' });
        expect(listener).toHaveBeenCalledTimes(1);
    });
    it('equality checks the initial and next value and calls only once', () => {
        const dependency = (0, __1.createFacet)({ initialValue: { value: 1 } });
        const result = fn(dependency, (a) => ({ value: `${a.value}` }), __1.shallowObjectEqualityCheck);
        const listener = jest.fn();
        result.observe(listener);
        expect(listener).toHaveBeenCalledWith({ value: '1' });
        expect(listener).toHaveBeenCalledTimes(1);
        listener.mockClear();
        dependency.set({ value: 1 });
        expect(listener).not.toBeCalled();
    });
});
//# sourceMappingURL=mapFacetSingle.spec.js.map